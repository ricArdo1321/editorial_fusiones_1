"use strict";(()=>{var e={};e.id=518,e.ids=[518],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1217:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>b,originalPathname:()=>y,patchFetch:()=>g,requestAsyncStorage:()=>p,routeModule:()=>f,serverHooks:()=>w,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>m});var o={};r.r(o),r.d(o,{DELETE:()=>l,GET:()=>u,PUT:()=>d});var a=r(5419),n=r(9108),s=r(9678),i=r(8070),c=r(3933);async function u(e,{params:t}){try{let e=process.env.WORDPRESS_API_URL||"https://cms.editorialfusiones.com/wp-json/wp/v2",r=await fetch(`${e}/libro/${t.id}`,{cache:"no-store"});if(!r.ok)return i.Z.json({error:"Book not found"},{status:404});let o=await r.json();return i.Z.json({id:o.id,title:o.title.rendered,author:o.acf?.autor||"",isbn:o.acf?.isbn||"",score:o.acf?.score||0,category:o.acf?.category||"NOVELA"})}catch(e){return console.error("Error fetching book:",e),i.Z.json({error:"Failed to fetch book"},{status:500})}}async function d(e,{params:t}){try{let r=await e.json(),o=await (0,c.u8)(parseInt(t.id),{title:r.title,acf:{autor:r.author,isbn:r.isbn,score:r.score,category:r.category}});return i.Z.json(o)}catch(e){return console.error("Error updating book:",e),i.Z.json({error:"Failed to update book"},{status:500})}}async function l(e,{params:t}){try{return await (0,c.MC)(parseInt(t.id)),i.Z.json({success:!0})}catch(e){return console.error("Error deleting book:",e),i.Z.json({error:"Failed to delete book"},{status:500})}}let f=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/admin/books/[id]/route",pathname:"/api/admin/books/[id]",filename:"route",bundlePath:"app/api/admin/books/[id]/route"},resolvedPagePath:"/home/ricardo/editorial_fusiones_1/app/api/admin/books/[id]/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:p,staticGenerationAsyncStorage:h,serverHooks:w,headerHooks:b,staticGenerationBailout:m}=f,y="/api/admin/books/[id]/route";function g(){return(0,s.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:h})}},3933:(e,t,r)=>{r.d(t,{CP:()=>w,EC:()=>m,IY:()=>y,Jq:()=>u,MC:()=>E,a7:()=>f,el:()=>l,fR:()=>b,qb:()=>h,r4:()=>p,u8:()=>g,zQ:()=>d});let o=process.env.WORDPRESS_API_URL||"https://cms.editorialfusiones.com/wp-json/wp/v2",a=process.env.WORDPRESS_USER||"",n=process.env.WORDPRESS_APP_PASSWORD||"";function s(e){return{id:e.id,slug:e.slug,title:e.title.rendered,excerpt:e.excerpt.rendered.replace(/<[^>]*>/g,"").trim(),content:e.content.rendered,date:new Date(e.date).toLocaleDateString("es-ES"),status:e.status,image:e._embedded?.["wp:featuredmedia"]?.[0]?.source_url}}function i(e){return{id:e.id,slug:e.slug,title:e.title.rendered,author:e.acf?.autor||"",isbn:e.acf?.isbn||"",score:e.acf?.score||0,category:e.acf?.category||"NOVELA",coverUrl:e._embedded?.["wp:featuredmedia"]?.[0]?.source_url}}function c(){if(!a||!n)throw Error("WordPress credentials not configured");let e=Buffer.from(`${a}:${n}`).toString("base64");return{Authorization:`Basic ${e}`,"Content-Type":"application/json"}}async function u(){try{let e=await fetch(`${o}/posts?_embed&per_page=100&status=publish`,{next:{revalidate:60}});if(!e.ok)return[];return(await e.json()).map(s)}catch(e){return console.error("Error fetching posts:",e),[]}}async function d(e){try{let t=await fetch(`${o}/posts?slug=${e}&_embed`,{next:{revalidate:60}});if(!t.ok)return null;let r=await t.json();if(0===r.length)return null;return s(r[0])}catch(e){return console.error("Error fetching post:",e),null}}async function l(e=3){try{let t=await fetch(`${o}/posts?_embed&per_page=${e}&status=publish`,{next:{revalidate:60}});if(!t.ok)return[];return(await t.json()).map(s)}catch(e){return console.error("Error fetching latest posts:",e),[]}}async function f(){let e=await fetch(`${o}/posts?_embed&per_page=100&status=any`,{headers:c(),cache:"no-store"});if(!e.ok)throw Error("Failed to fetch posts");return(await e.json()).map(s)}async function p(e){let t=await fetch(`${o}/posts/${e}?_embed`,{headers:c(),cache:"no-store"});return t.ok?s(await t.json()):null}async function h(e){let t=await fetch(`${o}/posts`,{method:"POST",headers:c(),body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to create post");return s(await t.json())}async function w(e,t){let r=await fetch(`${o}/posts/${e}`,{method:"PUT",headers:c(),body:JSON.stringify(t)});if(!r.ok)throw Error("Failed to update post");return s(await r.json())}async function b(e){if(!(await fetch(`${o}/posts/${e}?force=true`,{method:"DELETE",headers:c()})).ok)throw Error("Failed to delete post")}async function m(){let e=await fetch(`${o}/libro?_embed&per_page=100`,{headers:c(),cache:"no-store"});if(!e.ok)throw Error("Failed to fetch books");return(await e.json()).map(i)}async function y(e){let t=await fetch(`${o}/libro`,{method:"POST",headers:c(),body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to create book");return i(await t.json())}async function g(e,t){let r=await fetch(`${o}/libro/${e}`,{method:"PUT",headers:c(),body:JSON.stringify(t)});if(!r.ok)throw Error("Failed to update book");return i(await r.json())}async function E(e){if(!(await fetch(`${o}/libro/${e}?force=true`,{method:"DELETE",headers:c()})).ok)throw Error("Failed to delete book")}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[638,206],()=>r(1217));module.exports=o})();